default:
  image: python:3.8

stages:
  - test
  - build
  - release

smoke_test:
    stage: test
    image: docker:stable
    services:
      - docker:dind
    script:
      - curl -L "https://github.com/docker/compose/releases/download/1.25.4/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose && chmod +x /usr/local/bin/docker-compose
      - docker-compose build backend frontend telegram-bot

check_formatting:
    stage: test
    script:
      - pip install -r requirements.txt
      - echo "Testing..."
      - black --check backend/ frontend/ telegram-bot/
